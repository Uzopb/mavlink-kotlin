# mavlink-kotlin
A modern MAVLink handling library for the JVM written in Kotlin.

## Key Design Considerations

### Reflection-less serialization and deserialization
Reflection-based code can be prone to errors, difficult to understand and difficult for compiler to optimize.
Mavlink-Kotlin heavily uses code-gen to avoid reflection and provide compile-time safety.

In-fact, we've even tested it against other available MAVLink implementations for the JVM, and this library is
**20,000x to 45,000x** faster in terms of serialization and deserialization speeds and provides a much better memory
footprint. Don't believe us? try out the comparison tests in the `mavlink-kotlin` module.

### Interface-based API and modular design
Don't think the in-built implementation is good enough? No issues. Write your own code generators for the messages,
enums, dialects etc. and the rest of the modules will work without requiring a reimplementation.

### Message generator Gradle plugin:
You can provide your own dialect files and the Gradle plugin will take care of generating the messages. We use it to
generate and maintain your own private MAVLink message implementations for your drone systems, as we do ourselves.

### Support for Kotlin Multiplatform (future):
Target Android, Native, iOS and Desktop applications using the same codebase.

## Project Structure

### api
Interfaces, annotations and wrapper/helper classes for the MAVLink protocol. These are used in the generator module for
creating the enums, messages and dialects. MAVLink classes generated by any other generator would still work with the
other modules given 

### serialization
Tools for serializing and deserializing MAVLink message/frame Kotlin objects to and from a byte stream. More
specifically it contains extension functions on `ByteBuffer` to encode and decode different sizes of int, uint, float,
strings/characters, arrays, etc.

### generator
MAVLink generator Gradle Plugin that uses the api and serialization modules to generate the MAVLink classes. This plugin
has been published to the Gradle Plugin Portal with ID `xyz.urbanmatrix.mavlink.generator`. It can be used by anyone to
generate MAVLink classes from their own XML files. No need to fork this project.

The instructions on how to use the plugin is available in the generator module.

### definitions
Implementation of the standard MAVLink messages form the official [MAVLink repository](https://github.com/mavlink/mavlink) generated using the Gradle plugin.

### mavlink-kotlin
Implementation of the api module for the handling of data streams and connections for different protocols like TCP, UDP
and serial. It contains the interface `MavConnection` which acts as the base for various connection types. It is later
used by the different adapters to provide a simple end-user API.

### adapters
The mavlink-kotlin itself only handles the connections and provides reader and writer methods to and from byte streams.
The adapter module wraps the mavlink-kotlin connection classes to provide an abstraction layer that makes handling of
the connections easy.

Users can use the `MavConnection` interface to create an adapter of their own. Some adapters already available are:
- RxJava2
- RxJava3
- Kotlin Coroutines (in-development) 

Detailed instructions on how to use these are available in the respective adapter directories.
